<!DOCTYPE html>
<html lang="en" class="yui-overrride">
<head>
    <meta charset="utf-8">
    <title>lib/assets/javascripts/up/form.js.coffee - up.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1 class="blue-main-title">up.js</h1>
        </div>
        <div class="yui3-u-1-4 version project-version">
            API Docs for: 0.0
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/up.browser.html">up.browser</a></li>
                                <li><a href="../classes/up.bus.html">up.bus</a></li>
                                <li><a href="../classes/up.flow.html">up.flow</a></li>
                                <li><a href="../classes/up.form.html">up.form</a></li>
                                <li><a href="../classes/up.history.html">up.history</a></li>
                                <li><a href="../classes/up.link.html">up.link</a></li>
                                <li><a href="../classes/up.magic.html">up.magic</a></li>
                                <li><a href="../classes/up.marker.html">up.marker</a></li>
                                <li><a href="../classes/up.modal.html">up.modal</a></li>
                                <li><a href="../classes/up.motion.html">up.motion</a></li>
                                <li><a href="../classes/up.navigation.html">up.navigation</a></li>
                                <li><a href="../classes/up.popup.html">up.popup</a></li>
                                <li><a href="../classes/up.tooltip.html">up.tooltip</a></li>
                                <li><a href="../classes/up.util.html">up.util</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/up.html">up</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: lib/assets/javascripts/up/form.js.coffee</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        ###*
                        Form handling
                        @class up.form
                        ###
                        up.form = (-&gt;
                          
                          u = up.util
                        
                          ###*
                          Submits a form using the Up.js flow.
                        
                          @method up.submit
                          @param {Element|jQuery|String} formOrSelector
                            A reference or selector for the form to submit.
                            If the argument points to an element that is not a form,
                            Up.js will search its ancestors for the closest form.
                          @param {String} [options.target]
                          @param {String} [options.failTarget]
                          @param {Boolean|String} [options.history=true]
                            Successful form submissions will add a history entry and change the browser&#x27;s
                            location bar if the form either uses the &#x60;GET&#x60; method or the response redirected
                            to another page (this requires the &#x60;upjs-rails&#x60; gem).
                            If want to prevent history changes in any case, set this to &#x60;false&#x60;.
                            If you pass a &#x60;String&#x60;, it is used as the URL for the browser history.
                          @param {String} [options.transition]
                          @param {String} [options.failTransition]
                          @return {Promise}
                            A promise for the AJAX response
                          @example
                              up.submit(&#x27;form&#x27;)
                          ###
                          submit = (formOrSelector, options) -&gt;
                            
                            $form = $(formOrSelector).closest(&#x27;form&#x27;)
                        
                            options = u.options(options)
                            successSelector = u.option(options.target, $form.attr(&#x27;up-target&#x27;), &#x27;body&#x27;)
                            failureSelector = u.option(options.failTarget, $form.attr(&#x27;up-fail-target&#x27;), -&gt; u.createSelectorFromElement($form))
                            historyOption = u.option(options.history, $form.attr(&#x27;up-history&#x27;), true)
                            successTransition = u.option(options.transition, $form.attr(&#x27;up-transition&#x27;))
                            failureTransition = u.option(options.failTransition, $form.attr(&#x27;up-fail-transition&#x27;))
                            
                            $form.addClass(&#x27;up-active&#x27;)
                        
                            request = {
                              url: $form.attr(&#x27;action&#x27;) || up.browser.url()
                              type: $form.attr(&#x27;method&#x27;)?.toUpperCase() || &#x27;POST&#x27;,
                              data: $form.serialize(),
                              selector: successSelector
                            }
                        
                            successUrl = (xhr) -&gt;
                              url = if historyOption
                                if u.isString(historyOption)
                                  historyOption
                                else if redirectLocation = xhr.getResponseHeader(&#x27;X-Up-Previous-Redirect-Location&#x27;)
                                  redirectLocation
                                else if request.type == &#x27;GET&#x27;
                                  request.url + &#x27;?&#x27; + request.data
                              u.option(url, false)
                        
                            u.ajax(request)
                              .always -&gt;
                                $form.removeClass(&#x27;up-active&#x27;)
                              .done (html, textStatus, xhr) -&gt;
                                up.flow.implant(successSelector, html,
                                  history: successUrl(xhr),
                                  transition: successTransition
                                )
                              .fail (xhr, textStatus, errorThrown) -&gt;
                                html = xhr.responseText
                                up.flow.implant(failureSelector, html,
                                  transition: failureTransition
                                )
                        
                          ###*
                          Observes an input field by periodic polling its value.
                          Executes code when the value changes.
                        
                          This is useful for observing text fields while the user is typing,
                          since browsers will only fire a &#x60;change&#x60; event once the user
                          blurs the text field.
                        
                          @method up.observe
                          @param {Element|jQuery|String} fieldOrSelector
                          @param {Function|String} options.change
                            The callback to execute when the field&#x27;s value changes.
                            If given as a function, it must take two arguments (&#x60;value&#x60;, &#x60;$field&#x60;).
                            If given as a string, it will be evaled as Javascript code in a context where
                            (&#x60;value&#x60;, &#x60;$field&#x60;) are set.
                          @param {Number} [options.frequency=500]
                          @example
                              up.observe(&#x27;input&#x27;, { change: function(value, $input) { 
                                up.submit($input) 
                              } }); 
                          ###
                          observe = (fieldOrSelector, options) -&gt;
                        
                            $field = $(fieldOrSelector)
                            options = u.options(options, frequency: 500)
                            knownValue = null
                            timer = null
                            callback = null
                            if codeOnChange = $field.attr(&#x27;up-observe&#x27;)
                              callback = (value, $field) -&gt;
                                eval(codeOnChange)
                            else if options.change
                              callback = options.change
                            else
                              u.error(&#x27;observe: No change callback given&#x27;)
                        
                            check = -&gt;
                              value = $field.val()
                              skipCallback = _.isNull(knownValue) # don&#x27;t run the callback for the check during initialization
                              if knownValue != value
                                knownValue = value
                                callback.apply($field.get(0), [value, $field]) unless skipCallback
                        
                            resetTimer = -&gt;
                              if timer
                                clearTimer()
                                startTimer()
                        
                            clearTimer = -&gt;
                              clearInterval(timer)
                              timer = null
                        
                            startTimer = -&gt;
                              timer = setInterval(check, options.frequency)
                        
                            # reset counter after user interaction
                            $field.bind &quot;keyup click mousemove&quot;, resetTimer # mousemove is for selects
                        
                            check()
                            startTimer()
                        
                            # return destructor
                            return clearTimer
                        
                          ###*
                          @method form[up-target]
                          @param {String} up-target
                          @param {String} [up-fail-target]
                          @param {String} [up-history]
                          @param {String} [up-transition]
                          @param {String} [up-fail-transition]
                          @example
                              &lt;form method=&quot;POST&quot; action=&quot;/users&quot; up-target=&quot;.main&quot;&gt;  
                                ...    
                              &lt;/form&gt;
                          ###
                          up.on &#x27;submit&#x27;, &#x27;form[up-target]&#x27;, (event, $form) -&gt;
                            event.preventDefault()
                            submit($form)
                        
                          ###*
                          @method input[up-observe]
                          @param {String} up-observe 
                          @example
                              &lt;form method=&quot;GET&quot; action=&quot;/search&quot;&gt;  
                                &lt;input type=&quot;query&quot; up-observe=&quot;up.form.submit(this)&quot;&gt;    
                              &lt;/form&gt;
                          ###
                          up.awaken &#x27;[up-observe]&#x27;, ($field) -&gt;
                            return observe($field)
                        
                        #  up.awaken &#x27;[up-autosubmit]&#x27;, ($field) -&gt;
                        #    return observe($field, change: -&gt;
                        #      $form = $field.closest(&#x27;form&#x27;)
                        #      $field.addClass(&#x27;up-active&#x27;)
                        #      up.submit($form).always -&gt;
                        #        $field.removeClass(&#x27;up-active&#x27;)
                        #    )
                        
                          submit: submit
                          observe: observe
                        
                        )()
                        
                        up.submit = up.form.submit
                        up.observe = up.form.observe
                        
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>
</script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
